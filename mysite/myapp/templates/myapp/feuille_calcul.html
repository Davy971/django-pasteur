{% extends 'myapp/base.html' %}
{% load crispy_forms_tags %}
{% block content %}
    <h1> Entrer vos données</h1>

   <form method="post" action="">
       {% csrf_token %}
       {{ formset.management_form }}
       <table id="formset" class="form">
        {% for form in formset.forms %}
          {% if forloop.first %}
          <thead><tr>
            {% for field in form.visible_fields %}
            <th>{{ field.label|capfirst }}</th>
            {% endfor %}
          </tr></thead>
          {% endif %}
          <tr >
          {% for field in form.visible_fields %}
            <td>
            {# Include the hidden fields in the form #}
            {% if forloop.first %}
              {% for hidden in form.hidden_fields %}
              {{ hidden }}
              {% endfor %}
            {% endif %}
              {{ field.errors.as_ul }}
              {{ field }}
            </td>
          {% endfor %}
          </tr>
        {% endfor %}
        </table>
        <input name="valider" type="submit" value="Valider Analyses">
        <button onclick= myFunction()    type="button">Générer résultats</button>
    </form>




{% endblock %}

{%block javascripts %}
{{ block.super }}
<script>
function myFunction()
{
    var nom1;
    var nom2;
    var nom3;
    var val1;
    var val2;
    var val3;
    var tmp  = "id_form-" ;
    var compteur;
    for (compteur = 0; compteur < 7; compteur++)
    {
        nom1 = "-m1";
        nom2 ="-mb";
        nom3 = "-resultat";
        nom1=tmp+compteur+nom1;
        nom2=tmp+compteur+nom2;
        nom3=tmp+compteur+nom3;
        val1=parseFloat((document.getElementById(nom1).value).replace(",", "."));
        val2=parseFloat((document.getElementById(nom2).value).replace(",", "."));
        val3= val1+val2;
        document.getElementById(nom3).value = val3;
    }
}

</script>
{% endblock %}
